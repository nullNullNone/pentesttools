#coding=utf8
from lxml import etree
import sys
import time
host = sys.argv[1]
url = host+"/"+"?author={}"

def fileputcontent(file,msg,Append="w"):
    with open(file,Append) as f:
        f.write(msg)
        f.close()

def obj_solve(obj,rules = {}):
    src = etree.HTML(obj)
    res = {}
    for x in rules:
        try:
            res[x]=src.xpath(rules[x])
        except:
            pass
    return res

def GET(url,head = {},**opt):
    cookie = opt.get("cookie","")
    ua = opt.get("ua","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36")
    gap = opt.get("gap",0)
    timeout = opt.get("timeout",5)
    retry = opt.get("retry",0)
    import time
    import requests
    resp = None
    if head.get("Cookie",True):
        head["Cookie"] = cookie
    if head.get("User-Agent",True):
        head["User-Agent"] = ua
    if retry != 0:
        if type(retry) in [type([]),type({}),type((1,2,3))]:
            while True:
                resp = requests.get(url=url, headers=head, timeout=timeout)
                stacode = resp.status_code
                time.sleep(gap)
                if stacode in retry:
                    continue
                else:
                    break
        if type(retry) in [type(""),type(123)]:
            while True:
                resp = requests.get(url=url, headers=head, timeout=timeout)
                stacode = resp.status_code
                time.sleep(gap)
                if stacode != int(retry):
                    continue
                else:
                    break
    else:
        resp = requests.get(url=url, headers=head, timeout=timeout)

    return resp

for x in range(1,100000):
    resp = GET(url=url.format(str(x)))
    resp.encoding = "utf-8"
    text = resp.text
    user = obj_solve(text,{"res":"/html/head/title/text()"}).get("res","")[0]
    print(user.split(" ")[0])
    time.sleep(1)


